<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8"/>
	<meta name="description"	content="Data Visualisation"/>
	<meta name="keywords"		  content="HTML, CSS, D3"/>
	<meta name="author"			  content="Nguyen Tuan Khanh"/>

	<title>Task 2.2 D3 Data Bar Chart</title>
	
	<script src="https://d3js.org/d3.v7.min.js"></script>

</head>
<body>

	<h1>Drawing with Data</h1>
	
	<script>
	var w = 500;
	var h = 120;
	var padding = 1;

	var dataset = [14, 5, 26, 23, 9, 12, 18, 7, 15, 20, 
		30, 11, 8, 22, 17, 6, 4, 3, 2, 1];

	var svg = d3.select("body")
		.append("svg")
		.attr("width", w)
		.attr("height", h);

	svg.selectAll("rect")
		.data(dataset)
		.enter()
		.append("rect")
		.attr("x", function (d, i) {
			return i * (w / dataset.length); 
		})
		.attr("y", function (d) {
			return h - d * 4;
		})
		.attr("width", w / dataset.length - padding)
		.attr("height", function (d) {
			return d * 4;
		})
		.attr("fill", function (d) {
			return "rgb(0, " + (d * 6) + " , " + (d * 30) + ")";
		})

	svg.selectAll("text")
		.data(dataset)
		.enter()
		.append("text")
		.text(function (d) {
			return d;
		})
		.attr("x", function (d, i) {
			return i * (w / dataset.length) + (w / dataset.length - padding) / 2;
		})
		.attr("y", function (d) {
			if (d * 4 < 20) { 		// If the bar is short, reposition the text to be above the bar
				return h - d * 4 - 5;
			}
			return h - d * 4 + 15;
		})
		.attr("font-family", "sans-serif")
		.attr("font-size", "11px")
		.attr("fill", function (d) {
			if (d * 4 < 20) {
				return "black";		// If the bar is short, change the color to black for more clarity
			}
			return "white";
		})
		.attr("text-anchor", "middle");

	</script>
	
	<br>
	<br>
	<footer style="color:grey">COS30045 Data Visualisation<br>
		Nguyen Tuan Khanh</footer>
</body>
</html>
